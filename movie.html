
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Watch – HiJaVerse</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <a class="btn ghost" href="index.html">⬅ Back</a>
    <div class="ad">Ad space</div>
    <div id="wrap" class="details"></div>
    <hr>
    <footer>Only add movies you own, have permission for, or are public domain.</footer>
  </div>

<script>
function getParam(name){ const u=new URL(location.href); return u.searchParams.get(name); }

function renderPlayer(m){
  const box = document.createElement('div');
  box.className = 'video';
  if(m.watch_type === 'youtube' || m.watch_type === 'drive'){
    const iframe = document.createElement('iframe');
    iframe.src = m.watch_url;
    iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
    iframe.allowFullscreen = true;
    iframe.style = "width:100%;height:100%";
    box.appendChild(iframe);
  }else if(m.watch_type === 'mp4'){
    const v = document.createElement('video');
    v.src = m.watch_url;
    v.controls = true;
    v.style = "width:100%;height:100%";
    box.appendChild(v);
  }else{
    box.innerHTML = '<div class="notice">No player – add a valid watch_type.</div>';
  }
  return box;
}

async function load(){
  const id = getParam('id');
  const res = await fetch('movies.json');
  const data = await res.json();
  const m = data.find(x=>x.id===id) || data[0];

  const wrap = document.getElementById('wrap');
  wrap.innerHTML = '';
  const poster = document.createElement('img');
  poster.className = 'poster';
  poster.src = m.poster;
  poster.alt = m.title + ' poster';

  const info = document.createElement('div');
  info.innerHTML = \`
    <h1>\${m.title}</h1>
    <p class="meta">\${m.year} • \${(m.genre||[]).join(', ')} • Rated \${m.rating||'NR'}</p>
    <p>\${m.description||''}</p>
  \`;

  info.appendChild(renderPlayer(m));
  const links = document.createElement('p');
  links.innerHTML = \`
    <a class="btn" href="\${m.download_url}" target="_blank" rel="noopener">Download / Watch</a>
  \`;
  info.appendChild(links);

  wrap.appendChild(poster);
  wrap.appendChild(info);
}
load();
</script>
</body>
</html>
